
% AGUJournalTemplate.tex: this template file is for articles formatted with LaTeX
%
% This file includes commands and instructions
% given in the order necessary to produce a final output that will
% satisfy AGU requirements, including customized APA reference formatting.
%
% You may copy this file and give it your
% article name, and enter your text.
%
%
% Step 1: Set the \documentclass
%
%

%% To submit your paper:
\documentclass[draft]{agujournal2019}
\usepackage{url} %this package should fix any errors with URLs in refs.
\usepackage{lineno}
\usepackage[inline]{trackchanges} %for better track changes. finalnew option will compile document with changes incorporated.
\usepackage{soul}
\linenumbers

%%%%%%%
% As of 2018 we recommend use of the TrackChanges package to mark revisions.
% The trackchanges package adds five new LaTeX commands:
%
%  \note[editor]{The note}
%  \annote[editor]{Text to annotate}{The note}
%  \add[editor]{Text to add}
%  \remove[editor]{Text to remove}
%  \change[editor]{Text to remove}{Text to add}
%
% complete documentation is here: http://trackchanges.sourceforge.net/
%%%%%%%

\draftfalse

%% Enter journal name below.
%% Choose from this list of Journals:
%
% JGR: Atmospheres
% JGR: Biogeosciences
% JGR: Earth Surface
% JGR: Oceans
% JGR: Planets
% JGR: Solid Earth
% JGR: Space Physics
% Global Biogeochemical Cycles
% Geophysical Research Letters
% Paleoceanography and Paleoclimatology
% Radio Science
% Reviews of Geophysics
% Tectonics
% Space Weather
% Water Resources Research
% Geochemistry, Geophysics, Geosystems
% Journal of Advances in Modeling Earth Systems (JAMES)
% Earth's Future
% Earth and Space Science
% Geohealth
%
% ie, \journalname{Water Resources Research}

\journalname{Journal of Advances in Modeling Earth Systems (JAMES)}


\begin{document}

%% ------------------------------------------------------------------------ %%
%  Title
%
% (A title should be specific, informative, and brief. Use
% abbreviations only if they are defined in the abstract. Titles that
% start with general keywords then specific terms are optimized in
% searches)
%
%% ------------------------------------------------------------------------ %%

% Example: \title{This is a test title}

\title{Impact of grids and dynamical cores in CESM2.2 on the surface mass balance of the Greenland Ice Sheet}

%% ------------------------------------------------------------------------ %%
%
%  AUTHORS AND AFFILIATIONS
%
%% ------------------------------------------------------------------------ %%

% Authors are individuals who have significantly contributed to the
% research and preparation of the article. Group authors are allowed, if
% each author in the group is separately identified in an appendix.)

% List authors by first name or initial followed by last name and
% separated by commas. Use \affil{} to number affiliations, and
% \thanks{} for author notes.
% Additional author notes should be indicated with \thanks{} (for
% example, for current addresses).

% Example: \authors{A. B. Author\affil{1}\thanks{Current address, Antartica}, B. C. Author\affil{2,3}, and D. E.
% Author\affil{3,4}\thanks{Also funded by Monsanto.}}
\authors{Adam R. Herrington \affil{1}, Marcus Lofverstrom \affil{2}, Peter H. Lauritzen \affil{1} and Andrew Gettelman \affil{1}}

 \affiliation{1}{National Center for Atmospheric Research, 1850 Table Mesa Drive, Boulder, Colorado, USA}
\affiliation{2}{Department of Geosciences, University of Arizona, 1040 E. 4th Street, Tucson, AZ USA}

% \affiliation{1}{First Affiliation}
% \affiliation{2}{Second Affiliation}
% \affiliation{3}{Third Affiliation}
% \affiliation{4}{Fourth Affiliation}

%\affiliation{=number=}{=Affiliation Address=}
%(repeat as many times as is necessary)

%% Corresponding Author:
% Corresponding author mailing address and e-mail address:

% (include name and email addresses of the corresponding author.  More
% than one corresponding author is allowed in this LaTeX file and for
% publication; but only one corresponding author is allowed in our
% editorial system.)

% Example: \correspondingauthor{First and Last Name}{email@address.edu}

\correspondingauthor{=name=}{=email address=}

%% Keypoints, final entry on title page.

%  List up to three key points (at least one is required)
%  Key Points summarize the main points and conclusions of the article
%  Each must be 140 characters or fewer with no special characters or punctuation and must be complete sentences

% Example:
% \begin{keypoints}
% \item	List up to three key points (at least one is required)
% \item	Key Points summarize the main points and conclusions of the article
% \item	Each must be 140 characters or fewer with no special characters or punctuation and must be complete sentences
% \end{keypoints}

\begin{keypoints}
\item enter point 1 here
\item enter point 2 here
\item enter point 3 here
\end{keypoints}

%% ------------------------------------------------------------------------ %%
%
%  ABSTRACT and PLAIN LANGUAGE SUMMARY
%
% A good Abstract will begin with a short description of the problem
% being addressed, briefly describe the new data or analyses, then
% briefly states the main conclusion(s) and how they are supported and
% uncertainties.

% The Plain Language Summary should be written for a broad audience,
% including journalists and the science-interested public, that will not have 
% a background in your field.
%
% A Plain Language Summary is required in GRL, JGR: Planets, JGR: Biogeosciences,
% JGR: Oceans, G-Cubed, Reviews of Geophysics, and JAMES.
% see http://sharingscience.agu.org/creating-plain-language-summary/)
%
%% ------------------------------------------------------------------------ %%

%% \begin{abstract} starts the second page

\begin{abstract}
[ enter your Abstract here ]
\end{abstract}

\section*{Plain Language Summary}
[ enter your Plain Language Summary here or delete this section]


%% ------------------------------------------------------------------------ %%
%
%  TEXT
%
%% ------------------------------------------------------------------------ %%

%%% Suggested section heads:
\section{Introduction}

General Circulation Models (GCMs) are powerful tools for understanding the meteorology and climate of the high-latitudes, which are among the most sensitive regions on Earth to global and environmental change. Despite their importance, the numerical treatment of polar regions in GCMs is handled in vastly-different ways due to the so-called \textit{pole-problem} \cite{W2007JMSJ}, which refers to numerical instability arising from the convergence of meridians at the polar points on latitude-longitude grids (e.g., Figure~\ref{fig:uni-grids}a). Depending on the numerics, methods exist to suppress this instability, and latitude-longitude grids may be advantageous for polar processes as structures can be represented with more degrees of freedom than elsewhere in the computational domain. With the recent trend towards globally uniform unstructured grids, any potential benefits of latitude-longitude grids on polar regions may become a relic of the past. In this study, a spectrum of model grids and dynamical cores (hereafter referred to as \textit{dycores}) available in the Community Earth System Model, version 2.2 (CESM; \url{http://www.cesm.ucar.edu/models/cesm2/}) are evaluated to understand their impacts on the simulated characteristics of the Arctic, with a special focus on the meteorology over the Greenland Ice Sheet.

In the 1970's the pole problem was largely defeated through wide-spread adoption of efficient spectral transform methods in GCMs. These methods transform grid point fields into a global, isotropic representation in wave space, where linear operators (e.g. horizontal derivatives) in the equation set can be solved for exactly. While spectral transform methods are still used in the 21st century, local numerical methods have become desirable for their ability to run efficiently on massively parallel systems. The pole-problem has thus re-emerged in contemporary climate models that use latitude-longitude grids, and some combination of reduced grids and polar filters are necessary to ameliorate this instability \cite{JW2010LNCSE}. Polar filters are akin to a band-aid; they subdue the growth of unstable modes by applying additional damping to the solution over polar regions. One might expect that this additional damping reduces the effective resolution such that the resolved scales are similar across the entire domain, but this seems unlikely (describe why) and is explored further in this study.

An alternative approach is to use unstructured grids, which allow for more flexible grid structures that permit quasi-uniform grid spacing globally and eliminates the pole-problem entirely (e.g., Figure~\ref{fig:uni-grids}c). This grid flexibility also allows for variable-resolution or regional grid refinement (e.g., Figure~\ref{fig:vr-grids}). Grids can be developed with refinement over polar regions that could in principle make up for any loss in polar resolution in transitioning away from latitude-longitude grids (e.g., Figure~\ref{fig:vr-grids}), although this comes at the cost of a smaller CFL-limiting time-step in the refined region (the CFL-condition --- short for Courant–Friedrichs–Lewy condition --- is a necessary condition for numerical stability when using discrete data in time and space). However, unstructured grids scale more efficiently on parallel systems than latitude-longitude grids, likely resulting in a greater prevalence of unstructured grids as computing power continued to increase over time.

The meteorology and climate of the Arctic is characterized by a range of processes and scales that are difficult to represent in GCMs \cite{BETAL2001MWR,SG2017MWR,VETAL2018TC}. For example, while synoptic scale storms are generally well represented at typical GCM resolutions of 1 to 2 degrees \cite{JW2006QJR,IPCCAR5}, mesoscale Polar Lows are not well resolved at these resolutions. These mesoscale systems are prevalent during the cold season and produce gale-force winds that can induce large heat and moisture fluxes through the underlying sea-ice/ocean interface. The Arctic also contains the Greenland Ice Sheet (hereafter denoted as \textit{GrIS}). While it blankets the largest island in the world (Greenland), many of the processes that control the GrIS annual surface mass balance (the integrated sum of precipitation and melting) are only partially resolved at typical GCM resolutions. For example, GrIS precipitation is typically confined to the ice-sheet margins (predominately the southeastern margin) where orographic precipitation is generated by steep topographic slopes. Moreover, GrIS ablation areas (marginal regions where seasonal melting exceeds the annual mass input from precipitation) are typically 10s to 100\,km wide and confined to low-level areas or regions with limited precipitation. GCMs struggle to resolve the magnitude and extent of these features \cite{VETAL2018TC}, which can lead to unrealistic ice sheet growth in models with an interactive ice sheet component \cite<e.g.,>{LETAL2020JAMES}. 

The goal of this study is to characterize the representation of high-latitude regions using the spectral-element and finite-volume dycores in CESM2.2, as these models treat the high-latitudes, e.g., the pole-problem, in different ways. The manuscript is laid out as follows: Section~\ref{sec:methods} consists of documentation of the grids, dycores and physical parameterizations used in this study. The Arctic refined grids were developed by the authors, and this section serves as their official documentation in CESM2.2. Section~\ref{sec:methods} also contains a description of the experiments along with reanalysis datasets and post-processing software used for evaluating the model simulations. Section~\ref{sec:results} contains the results of the experiments, followed by Section~\ref{sec:conclusions} that provides a general discussion and conclusions.

\begin{figure}[t]
\begin{center}
\begin{tabular}{cc}
         \includegraphics[width=60mm]{figs/grid-f19.pdf}&
         \includegraphics[width=60mm]{figs/grid-f09.pdf}\\
         \includegraphics[width=60mm]{figs/grid-ne30pg2.pdf}&
         \includegraphics[width=60mm]{figs/grid-ne30pg3.pdf} \\
\end{tabular}
\end{center}
\caption{Computational grids for the uniform $1^{\circ}-2^{\circ}$ grids in this study.}
\label{fig:uni-grids}
\end{figure}

\begin{figure}[t]
\begin{center}
\begin{tabular}{cccc}
         \includegraphics[width=60mm]{figs/grid-ARCTIC.pdf}&
         \includegraphics[width=60mm]{figs/grid-ARCTICGRIS.pdf} \\
\end{tabular}
\end{center}
\caption{Spectral-element grid for the variable-resolution ARCTIC grid in this study. Note that this is not the computational grid; each element has $3\times3$ independent grid points.}
\label{fig:vr-grids}
\end{figure}

\section{Methods}\label{sec:methods}
\subsection{Dynamical cores}

The atmospheric component of CESM2.2, the Community Atmosphere Model, version 6.3 (CAM; \url{https://ncar.github.io/CAM/doc/build/html/index.html}), supports a number of different atmospheric dynamical cores. These include dycores using latitude-longitude grids, such as finite-volume \cite<FV;>{L2004MWR} and eulerian spectral transform \cite<EUL;>{CETAL006JC} models, and dycores built on unstructured grids, including spectral-element \cite<SE;>{LetAl2018JAMES} and finite-volume 3 \cite<FV3;>{PL2007JCP} models. The EUL dycore is the oldest dycore in CAM, and the least supported of all the dycores in the current model. FV3 is the newest dycore in CAM, but it was not fully incorporated at the time this work commenced; both the EUL and FV3 dycores are omitted from this study. As such, the results presented in this study are comparing the performance of the SE and FV dycores.

\subsubsection{Finite-volume (FV) dynamical core}

The FV dycore is a hydrostatic model that integrates the equations of motion using a finite-volume discretization on a spherical latitude-longitude grid \cite{LR1997QJR}. The 2D dynamics evolve in floating Lagrangian layers that are periodically mapped to Eulerian reference grid in the vertical \cite{L2004MWR}, using a hybrid-pressure vertical coordinate. Hyperviscous damping is applied to the divergent modes while Laplacian damping is applied to momentum in the top few layers, referred to as a \textit{sponge layer} \cite{L2011IJHPC}. A polar filter is used to avoid computational instability due to the convergence of the meridians, allowing for a more practical time-step. It takes the form of a Fourier filter in the zonal direction, with the damping coefficients increasing monotonically in the poleward direction \cite{ST1995GEOS}.

\subsubsection{Spectral-element (SE) dynamical core}

The SE dycore is a hydrostatic model that integrates the equations of motion using a high-order continuous Galerkin method \cite{TTI1997JCP,DetAl2012IJHPCA}. The computational domain is a cubed-sphere grid tiled with quadrilateral elements (e.g., Figure~\ref{fig:vr-grids}). Each element contains a fourth order basis set in each horizontal direction, with the solution defined at the roots of the basis functions, the Gauss-Lobatto-Legendre (GLL) quadrature points. This results in 16 GLL nodal points within each element, with 12 of the points lying on the (shared) element boundary. Communication between elements happens via the direct stiffness summation \cite{canuto2007}, which applies a numerical flux to the element boundaries that reconciles overlapping nodal values and produces a continuous global basis set. 

As with the FV dycore, the dynamics evolve in floating Lagrangian layers that are subsequently mapped to an Eulerian reference grid. A dry mass vertical coordinate was more recently implemented for thermodynamic consistency with condensates \cite{LetAl2018JAMES}. The 2D dynamics have no implicit dissipation and so hyperviscosity operators are applied to all prognostic variables to remove spurious numerical errors \cite{DetAl2012IJHPCA}. Laplacian damping is applied in the sponge layer.

The SE dycore supports regional grid refinement via its variable-resolution configuration, requiring two enhancements over uniform resolution grids. (1) As the numerical viscosity increases with resolution, explicit hyperviscosity relaxes according to the local element size, reducing in strength  by about an order of magnitude per halving of the grid spacing. A tensor-hyperviscosity formulation is used \cite{GetAl2014GMD}, which adjusts the coefficients in two orthogonal directions to more accurately target highly distorted quadrilateral elements. (2) The topography boundary conditions need to be smoothed in a way that does not excite grid scale modes, and so  the NCAR topography software \cite{gmdd-8-4623-2015} was modified to scale the smoothing radius by the local element size. 

For spectral-element grids with quasi-uniform grid spacing, a variant in which tracer advection is computed using the Conservative Semi-Lagrangian Multi-tracer transport scheme (CSLAM) is used instead \cite<>{LTOUNGK2017MWR}. CSLAM has improved tracer property preservation and accelerated multi-tracer transport. It uses a separate grid from the spectral-element dynamics, through dividing each element into $3\times3$ control volumes with quasi-equal area. The physical parameterizations are computed from the state on the CSLAM grid, which has clear advantages over the default SE dycore in which the physics are evaluated at the GLL nodal points \cite{HL2018MWR}. 

\subsection{Grids}

Six grid are evaluated in this study (Table X). The FV dycore is run with $1^{\circ}$ and $2^{\circ}$ grid spacing, referred to as $f09$ and $f19$, respectively (Figure~\ref{fig:uni-grids}a,b). The $1^{\circ}$ equivalent of the CAM-SE-CSLAM grid is also run, referred to as $ne30pg3$ (Figure~\ref{fig:uni-grids}c), where $ne$ refers to a grid with of $ne \times ne$ elements per cubed-sphere face, and $pg$ denotes that there are $pg \times pg$  control volumes per element for computing the physics. An additional $1^{\circ}$ CAM-SE-CSLAM grid is run, but with the physical paramerizations computed on a grid that contains $2\times2$ control volumes per element, $ne30pg2$ \cite<Figure~\ref{fig:uni-grids}d;>{HETAL2019JAMES}.

Two variable resolution meshes were developed as part of the CESM2.2 release that contains grid refinement over the Arctic (Figure~\ref{fig:vr-grids}). The Arctic meshes were developed using the software package SQuadgen (\url{https://github.com/ClimateGlobalChange/squadgen}). The $ARCTIC$ grid is a $1^{\circ}$ grid with $\frac{1}{4}^{\circ}$ regional refinement over the broader Arctic region. The $ARCTICGRIS$ grid is identical to the $ARCTIC$ grid, but contains an additional patch covering the big island of Greenland with $\frac{1}{8}^{\circ}$ resolution.

\subsection{Physical parameterizations}

The CAM6 physical parameterization package (hereafter referred to as the \textit{physics}; \url{https://ncar.github.io/CAM/doc/build/html/index.html}) is used for all simulations in this study. CAM6 physics is most noteably different from it's predecessors through the incorporation of high-order turbulence closure, Cloud Layers Unified by Binormals \cite<CLUBB;>{GETAL2002JAS,BOG2013JCLIM}, which jointly acts as a PBL, shallow convection and cloud macrophysics scheme. CLUBB is coupled with the MG2 microphysics scheme \cite{MG2}, with prognostic precipitation and classical nucleation theory in representing cloud ice for improved cloud-aerosol interactions. Deep convection is parameterized using a convective quasi-equilibrium mass flux scheme \cite{ZM1995AO,NRJ2008JC} inlcuding convective momentum transport \cite{RSG2010JAS}. PBL form drag is modeled after \cite{BBW2004QJRMS} and orographic gravity wave drag is represented with an anisotropic method informed by the orientation of topographic ridges at the sub-grid scale. 

The CAM convention is that the physics package determines the vertical resolution. Since all runs use CAM6 physics, all grids and dycores use 32 levels in the vertical, with a model top of about $1 \ hPa$ or about $40 \ km$. The physics time-step, in contrast, is dependent on grid resolution. Increases in horizontal resolution permit faster vertical velocities that reduce characteristic time-scales, and so the physics time-step should be reduced to avoid large time truncation errors \cite{HR2018JAMES}. The $ARCTIC$ and $ARCTICGRIS$ grids are therefore run with a $4\times$ and $8\times$ reduction in physics time-step relative to the default 1800 s time-step used in coarser, uniform resolution grids.

\subsection{Experimental design}

All grids and dycores are run using an identical transient 1979-1998 AMIP-style configuration, with prescribed monthly SST/sea-ice after \cite{CESMSST}. This configuration refers to the $FHIST \ compset$ and runs out of the box in CESM2.2. The Community Land Model (CLM5; \url{https://escomp.github.io/ctsm-docs/versions/release-clm5.0/html/users_guide/index.html}), which uses the same grid as the atmosphere grid, calculates the surface energy balance at each land tile within a grid cell, which is used to compute snow and bare ice melting to inform the surface mass balance (SMB) of a glacier unit \cite{VKETAL2020JGR}. For land ice tiles coinciding with the Antarctic and Greenland Ice Sheets, the surface energy and mass balance are evaluated at ten elevation classes, and integrated over sub-grid hypsometric area-elevation bins for more accurate estimation of the surface mass balance of the big ice sheets. Ice accumulation is modeled as a capping flux, or snow in excess of the assumed 10 m snow cap, and refreezing of liquid within the snowpack additionally acts as a source of mass in the SMB calculation. Since the 10 m snowcap needs to be reached in the accumulation zone to simulate the SMB, the snow depths in the variable-resolution grids were spun-up  by forcing CLM5 standalone, cycling over 20 years of a fully coupled $ARCTIC$ run for about 500 years. The uniform resolution grids are all initialized with an SMB from an existing $f09$ spun-up initial condition. 

\subsection{SMB Analysis}

The SMB is the sum of the mass source term, accumulation (i.e., precipitation), and the mass sink term, ablation. Ablation can be expressed as sublimation plus total runoff, with runoff being a combination of liquid precipitation and snow and ice melt. Not all liquid precipitation becomes runoff; rain may penetrate pore spaces in the firn layer and freeze, forming ice lenses in the subsurface. All these processes are represented by different components in CESM, but the surface mass balance proper is computed by CLM. CLM uses a downscaling technique to account for sub-grid variability in SMB. In short, the ice sheet patch in a CLM grid cell is subdivided into 10 elevation classes (EC), weighted by their respective area fractions at each EC, which is derived from a high resolution GrIS elevation model. The near surface air temperature, humidity and air density are calculated at each EC using an assumed lapse rate and the elevation difference from the grid mean, allowing for the precipitation rates to be repartitioned into solid or liquid based on the temperature of each EC. This technique allows for a unique surface energy balance and surface mass balance at each EC. Integrating over all ECs using the area weights then provides a more accurate SMB. For a more detailed description of how the surface mass balance is computed in the CESM, see \cite{KETAL2020JAMES}.

\begin{figure}[t]
\begin{center}
         \includegraphics[width=130mm]{figs/temp_grisres.pdf}
\end{center}
\caption{The spatial properties of the GrIS as represented by different grids in this study. (Left) approximate average grid spacing over GrIS, (right) GrIS area error, computed as the relative differences from a 4km dataset used to create the CESM ice masks.}
\label{fig:grisdx}
\end{figure}

Simulated SMB are compared against several observational data products. RACMO2.3 11km and RACMO2.3p2 5.5km regional simulations forced by reanalysis at it's domain boundaries, performs very skillfully relative to observations and is therefore considered an ideal modeling target \cite{NETAL2019SCIENCE}. The Land Ice Verification and Validation toolkit (LIVVkit), version 2.1 \cite{LIVVkit} maintains a repository of snow pit and and ice core SMB measurements, as well as the IceBridge radar accumulation dataset.

A common high resolution dataset is used to generate the GrIS boundary conditions using the CLM dataset creation tools. Since we are interested in the total ice sheet SMB, we seek to integrate various components of the SMB over a common ice mask to get the total mass change over the GrIS. Figure~\ref{fig:grisdx} shows the GrIS ice mask area across the different grids, as a function of the number of grid points. Due to the use conservative regridding in the CLM tools, the interpolation errors are small and ice mask areas have less than $1.5\%$ errors relative to the raw ice mask dataset. RACMO, however, uses a smaller ice mask, about $3\%$ smaller than the raw CLM dataset. While Figure~\ref{fig:grisdx} suggests integrating quantities over the native ice mask of the six grids would probably not suffer from large errors due to differing ice masks, we seek to compare these integrated quantities with RACMO. Therefore, we have taken the approach of mapping all model fields to the lowest resolution grids and integrating over the respective low resolution ice masks. Due to the sensitivity of mapping errors to grid coordinates (i.e., unstructured or structured), all quantities are evaluated on both the $f19$ and $ne30pg2$ low resolution grids. In addition, two remapping packages are used; ESMF conservative and a TempestRemap high-order, monotone algorithm. In all, each integrated quantity is evaluated (at most) four times to provide an estimate of uncertainty due to differences in grid coordinates and remapping algorithm.

\section{Results}\label{sec:results}

\subsection{Tropospheric temperatures}

Before delving into the simulated characteristics of the Arctic, the global mean differences between the various grids and dycores are assessed. Figure~\ref{fig:dT-lores} shows the climatological, zonal mean height plots expressed as differences between the uniform resolution grids and dycores. The $f09$ grid is warmer than the $f19$ grid, primarily in the mid-to-high latitudes and throughout the depth of the troposphere. This is a common response to increasing horizontal resolution in GCMs \cite{PS2002CD,RETAL2006JC}, and \cite{HK2020QJRMS} has shown that this occurs in CAM due to greater resolved vertical velocities that in turn, facilitate greater condensational heating in the macrophyiscs routine in CLUBB. The right columns in Figure~\ref{fig:dT-lores} supports this interpretation, which shows an increase in the climatological CLUBB heating in the mid-latitudes in the $f09$ grid. 

As the SE dycore is less diffusive than the FV dycore, the resolved vertical velocities are larger in the SE dycore, and so a modest, resolution-like sensitivity occurs in which $ne30pg3$ is warmer than $f09$ (Figure~\ref{fig:dT-lores}). The stratosphere has a different response, in which $ne30pg3$ is much cooler than $f09$ in the mid-to-high latitudes. The differences in temperature between $ne30pg3$ and $ne30pg2$ are small, with a slight warming near the tropopause at high latitudes. This is consistent with the similar climates found between these grids in \cite{HETAL2019JAMES}.

Comparing the variable-resolution grids to the uniform resolution grids is complicated because we simultaneously increase the grid resolution and reduce the physics time-step, both which noticeably impact the solution \cite{W2008TELLUS}. An additional $ne30pg3$ simulations is run with the physics time-step used in the $ARCTIC$ grid, referred to as $ne30pg3^{*}$. Figure~\ref{fig:dT-hires} shows the change in climatological temperature in zonal-mean height space between $ne30pg3^{*}$ and $ne30pg3$. A similar warming response to increasing resolution occurs when the time-step is reduced, and the mechanism is similar in that the shorter time-step facilitates greater condensational heating by CLUBB. Figure~\ref{fig:dT-hires} shows the difference in climatological temperature between the $ARCTIC$ grid and the $ne30pg3^{*}$ grid. The greater condensational heating and warmer temperatures are confined to the regionally refined region when the impact of physics time-steps is removed from the analysis.

\subsection{Greenland surface mass balance}

The surface mass balance (SMB) of the Greenland Ice Sheet (GrIS) is simulated in all grids and dycores in this study. As the accuracy of the computed SMB is sensitive to grid resolution, Figure~\ref{fig:grisdx} shows the average grid spacing for all six grids in this study. The $ne30pg2$ grid has the coarsest representation with an average $\Delta x=160~km$, and the $ARCTICGRIS$ grid has the highest resolution with an average $\Delta x=14.6~km$, similar to the grid spacing of the $11~km$ RACMO model. The $ne30pg3$ grid has an average $\Delta x=111.2~km$, which is substantially more coarse than the $f09$ grid, having an average $\Delta x=60~km$. This is interesting because $ne30pg3$ and $f09$ have similar average grid spacing over the entire globe, and comparable computational costs, but due to the convergence of meridians the finite-volume model has enhanced resolution over GrIS. The $ARCTIC$ grid has an average grid spacing over GrIS of $\Delta x=27.8~km$, and is about 10 times more expensive than the $1^{\circ}$ models. The $ARCTICGRIS$ grid is about twice as expensive as the $ARCTIC$ grid.

The climatological mean precipitation bias over GrIS is shown in Figure~\ref{fig:grisdx}, defined as differences from the RACMO2.3p2 5.5km solution \cite{NETAL2019SCIENCE}. What sticks out is that the uniform $1^{\circ}-2^{\circ}$ grids have positive bias centered over the southern dome. The $ARCTIC$ runs improves this bias substantially, and is all but eliminated in $ARCTCIGRIS$ run. The southern dome bias is therefore due to inadequate horizontal resolution, which is consistent with the results of \cite{VETAL2018TC}. Southeast Greenland has the largest accumulation rates in GrIS due to synoptic systems moving in from the southeast, which become orographically lifted by the steep southeast ice sheet margin, dumping large amounts of precipitation along the southeast coast. At lower horizontal resolutions, the topography is too smooth and large amounts of moisture penetrates further inland, incorrectly dumping large amounts of precipitation onto the interior of the ice sheet.

Figure~\ref{fig:tseries} shows time-series of integrated precipitation and snow/ice melt over the GrIS in the various different grids and dycores, with both RACMO2.3 and 2.3p2 show in black. The 1979-1998 climatological mean values are provided as circles on the right side of the panels. The uniform $1^{\circ}-2^{\circ}$ grids all show a distinctive positive bias in precipitation due to this over-prediction of interior precipitation rates. The the variable-resolution grids have the smallest precipitation biases, providing a comparable solution to RACMO.The $f19$ and $f09$ perform similarly, with +110 Gt/yr bias, whereas $ne30pg3$ is biased by about +170 Gt/yr and $ne30pg2$, +230 Gt/yr. The results suggest that uniform resolution spectral-element grids have larger biases than the finite-volume grids, consistent with spectral-element grids having a coarser representation of GrIS (Figure~\ref{fig:grisdx}). While it seems likely that $ne30pg2$ has the largest bias of all the grids, it's difficult to say for certain that the $ne30pg3$ precipitation biases are worse than the finite-volume grids, owing to the use of a single realization for each grid.

The combined snow/ice melt integrated over the GrIS is given by the bottom panel of Figure~\ref{fig:tseries}. The $ARCTIC$ grid simulates the most realistic melt rates, with all other grids tending to have larger melt rates than RACMO. The $ARCTICGRIS$ grid over predicts melting by about 150 Gt/yr. This is likely due to an anomalously warm lower troposphere during the summer, relative to the $ARCTIC$ run (not shown). The $f19$ and $f09$ melting rates are improved over $ARCTICGRIS$, with a positive melt bias between 70-90 Gt/yr. The spectral-element grids have the largest positive melt bias, between 210-230 Gt/yr.

Figure~\ref{fig:pointdiff} shows the distribution of point-wise differences from LIVVkit observational database, as a violin plot. The IceBridge dataset is exclusively from the interior of the ice sheet and represents accumulation rates. The uniform $1^{\circ}-2^{\circ}$ grids have similar median errors of about +35-50 mm.w.e, while the variable-resolution errors are noticeably smaller. The in-situ observations in the accumulation zone, shown in the middle plot looks very similar to the IceBridge errors, and so provides confidence that the variable-resolution grids are outperforming the uniform grids in the interior accumulation zone. The errors evaluated at in-situ ablation zone measurements are in tension with the RACMO results in Figure~\ref{fig:tseries}, indicating that the uniform $1^{\circ}-2^{\circ}$ grids perform similarly, the $ARCTIC$ grid showing a reduction in bias and the $ARCTICGRIS$ having the smallest bias of all the grids. However, the in-situ ablation measurements are sparse in time and space, and so there is a large uncertainty in extending these results to the entirety of the ablation zone.

The infamous k-transect mass balance profile is contained in the LIVVkit database, and shown in Figure~\ref{fig:trans}, along with the all the simulations. The in-situ observation points seem to be nicely replicated by the $ARCTCIGRIS$ run, whereas the $ARCTIC$ grid seems to biased positive in the higher-elevations of the ablation zone. The $f09$ grid is surprisingly competitive with the variable-resolution grids, capturing a realistic slope of the elevation-SMB curve. The elevation-SMB slopes of the uniform spectral-element and $f19$ grid simulate too shallow a slope in the higher elevation regions of the k-transect. Figure~\ref{ztrans} shows the representation of the surface of the ice sheet along these transects in the simulations, compared to a high resolution elevation dataset. The $1^{\circ}-2^{\circ}$ grids are noticeably coarse, with only a handful of grid cells populating the transect. The $f09$ grid is a bit of an exception, since the grid cells become very narrow in the meridional direction at high latitudes, and so a larger number of grid cells can populate the transect, consistent with its skillful representation of the ablation zone.

What the authors refer to as the ``b-transect" in northwest Greenland (Figure~\ref{fig:trans}) is characterized by orographic precipitation, resulting in the accumulation zone extending down to the ice margin. The variable resolution grids perform relatively well, with larger SMBs at lower elevations where the precipitation rates are highest, whereas the $1^{\circ}-2^{\circ}$ grids underestimate the SMB in these lower elevation regions. Only the variable resolution grids can capture the local reduction in SMB in the 1500-2000 m region. The skill of the variable-resolution grids is clearly related to the accurate representation of this steep transect, while also capturing the protrusion around 1500-2000 m that coincides with the local minimum in SMB (Figure~\ref{ztrans}).

\subsection{Impact of horizontal resolution on extremes}
Synoptic storms are identified and analyzed using TempestExtremes \cite{UETAL2021}. The new $ARCTIC$ grid contains $\frac{1}{4}^{\circ}$ refinement north of about $45^{\circ}$ latitude, and so the storm tracker is applied to this region for the $ARCTIC$ and $ne30pg3$ run to identify differences in storm characteristics due to horizontal resolution. Figure~\ref{fig:comp-mean} shows the mean precipitation rates averaged over all January storms identified by TempestExtremes. The iconic comma structure of the mid-latitude cyclones is simulated in $ne30pg3$ and $ARCTIC$ grids, with the magnitudes about the same in these two grids, with perhaps a marginal increase in precipitation rates in the storm center of the $ARCTIC$ grid. For good measure, the $ne30pg3^{*}$ run is also plotted, and looks more-or-less identical to the $ne30pg3$ run.

As has been previously reported, horizontal resolution can have large impacts on extreme precipitation events. Figure~\ref{fig:comp-pdf} is a PDF of the precipitation rates associated with synoptic storms, by month. The $ARCTIC$ run has larger extreme precipitation rates compared to $ne30pg3$ in every month, but the increase is greatest in the summer months, which coincides with the most extreme events of the year. This is primarily due to an increase in resolution; the $ne30pg3^{*}$ only marginally increases the precipitation rates compared with $ne30pg3$. The $f09$ and $f19$ grids looks similar to $ne30pg3$, but with $f09$ having more frequent extreme precipitation events than $f19$ (not shown). It should also be noted that the PDFs are evaluated on an identical composite grid for all runs, and so storm statistics are not impacted by differences in output resolution.

The extreme precipitation rates in the $ARCTIC$ run are closer to the ERA5 reanalysis than in $ne30pg3$ (Figure~\ref{fig:comp-pdf}). It's difficult to know the extent that the extreme precipitation rates in ERA5 are constrained by data assimilation, or whether these precipitation rates are due to using a similar $\frac{1}{4}^{\circ}$ model as the $ARCTIC$ grid. However, precipitation rates in $\frac{1}{4}^{\circ}$ models tend to produce more skillful extreme events \cite{OETAL2016JAMES}. 

\subsection{Orographic gravity waves emanating from Greenland}
\subsection{Katabatic winds emanating from Greenland}

% \section{Materials and Methods}
% Here is text on Materials and Methods.
%
% \subsection{A descriptive heading about methods}
% More about Methods.
%
% \section{Data} (Or section title might be a descriptive heading about data)
%
% \section{Results} (Or section title might be a descriptive heading about the
% results)
%

\section{Conclusions}\label{sec:conclusions}

\begin{figure}[t]
\begin{center}
         \includegraphics[width=130mm]{figs/temp_dhgt_panel_STEND_CLUBB-lores.pdf}
\end{center}
\caption{.}
\label{fig:dT-lores}
\end{figure}

\begin{figure}[t]
\begin{center}
         \includegraphics[width=130mm]{figs/temp_dhgt_panel_STEND_CLUBB-hires.pdf}
\end{center}
\caption{.}
\label{fig:dT-hires}
\end{figure}

\begin{figure}[t]
\begin{center}
         \includegraphics[width=130mm]{figs/temp_diffRACMO23p2_5p5km.pdf}
\end{center}
\caption{Climatological (1979-1998) annual precipitation rate bias (in mm/yr) relative to the RACMO2.3p2 5.5km resolution data product \cite{NETAL2019SCIENCE}.}
\label{fig:prect}
\end{figure}

\begin{figure}[t]
\begin{center}
         \includegraphics[width=100mm]{figs/temp_tseries_GRIS.pdf}
\end{center}
\caption{Time-series of annual (solid+liquid) precipitation (top) and annual runoff (bottom) integrated over the Greenland Ice Sheet for all six simulations and compared to RACMO3.2. The raw fields are mapped to two target low resolution grids, f19 \& ne30pg2, and using two different remapping methods, conservative ESMF and high order TempestRemap. The remapped values are then integrated over the ice mask of the target grid. This gives four time-series for each simulation (three for f19 \& ne30pg2), with the mean value given by the solid line and shading spanning the extent of the remapped solutions.}
\label{fig:tseries}
\end{figure}

%\begin{figure}[t]
%\begin{center}
%         \includegraphics[width=100mm]{figs/temp_tseries_BASIN_uqmap.pdf}
%\end{center}
%\caption{.}
%\label{fig:zwally}
%\end{figure}

\begin{figure}[t]
\begin{center}
         \includegraphics[width=130mm]{figs/temp_violens.pdf}
\end{center}
\caption{.}
\label{fig:pointdiff}
\end{figure}

\begin{figure}[t]
\begin{center}
\begin{tabular}{cccc}
         \includegraphics[width=25mm]{figs/temp_icemask.pdf} \\
         \includegraphics[width=50mm]{figs/temp_zsmb_ktrans_obsperiod.pdf}&
         \includegraphics[width=50mm]{figs/temp_zsmb_btrans_obsperiod.pdf} \\
\end{tabular}
\end{center}
\caption{.}
\label{fig:trans}
\end{figure}

\begin{figure}[t]
\begin{center}
\begin{tabular}{cccc}
         \includegraphics[width=100mm]{figs/temp_ktransect.pdf} \\
         \includegraphics[width=100mm]{figs/temp_btransect.pdf} \\
\end{tabular}
\end{center}
\caption{.}
\label{fig:ztrans}
\end{figure}

\begin{figure}[t]
\begin{center}
         \includegraphics[width=130mm]{figs/temp_composite_ge45N_JAN-PRECT.pdf}
\end{center}
\caption{.}
\label{fig:comp-mean}
\end{figure}

\begin{figure}[t]
\begin{center}
         \includegraphics[width=130mm]{figs/temp_composite_ge45N_pdf.pdf}
\end{center}
\caption{.}
\label{fig:comp-pdf}
\end{figure}

%Text here ===>>>


%%

%  Numbered lines in equations:
%  To add line numbers to lines in equations,
%  \begin{linenomath*}
%  \begin{equation}
%  \end{equation}
%  \end{linenomath*}



%% Enter Figures and Tables near as possible to where they are first mentioned:
%
% DO NOT USE \psfrag or \subfigure commands.
%
% Figure captions go below the figure.
% Table titles go above tables;  other caption information
%  should be placed in last line of the table, using
% \multicolumn2l{$^a$ This is a table note.}
%
%----------------
% EXAMPLE FIGURES
%
% \begin{figure}
% \includegraphics{example.png}
% \caption{caption}
% \end{figure}
%
% Giving latex a width will help it to scale the figure properly. A simple trick is to use \textwidth. Try this if large figures run off the side of the page.
% \begin{figure}
% \noindent\includegraphics[width=\textwidth]{anothersample.png}
%\caption{caption}
%\label{pngfiguresample}
%\end{figure}
%
%
% If you get an error about an unknown bounding box, try specifying the width and height of the figure with the natwidth and natheight options. This is common when trying to add a PDF figure without pdflatex.
% \begin{figure}
% \noindent\includegraphics[natwidth=800px,natheight=600px]{samplefigure.pdf}
%\caption{caption}
%\label{pdffiguresample}
%\end{figure}
%
%
% PDFLatex does not seem to be able to process EPS figures. You may want to try the epstopdf package.
%

%
% ---------------
% EXAMPLE TABLE
%
% \begin{table}
% \caption{Time of the Transition Between Phase 1 and Phase 2$^{a}$}
% \centering
% \begin{tabular}{l c}
% \hline
%  Run  & Time (min)  \\
% \hline
%   $l1$  & 260   \\
%   $l2$  & 300   \\
%   $l3$  & 340   \\
%   $h1$  & 270   \\
%   $h2$  & 250   \\
%   $h3$  & 380   \\
%   $r1$  & 370   \\
%   $r2$  & 390   \\
% \hline
% \multicolumn{2}{l}{$^{a}$Footnote text here.}
% \end{tabular}
% \end{table}

%% SIDEWAYS FIGURE and TABLE
% AGU prefers the use of {sidewaystable} over {landscapetable} as it causes fewer problems.
%
% \begin{sidewaysfigure}
% \includegraphics[width=20pc]{figsamp}
% \caption{caption here}
% \label{newfig}
% \end{sidewaysfigure}
%
%  \begin{sidewaystable}
%  \caption{Caption here}
% \label{tab:signif_gap_clos}
%  \begin{tabular}{ccc}
% one&two&three\\
% four&five&six
%  \end{tabular}
%  \end{sidewaystable}

%% If using numbered lines, please surround equations with \begin{linenomath*}...\end{linenomath*}
%\begin{linenomath*}
%\begin{equation}
%y|{f} \sim g(m, \sigma),
%\end{equation}
%\end{linenomath*}

%%% End of body of article

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Optional Appendix goes here
%
% The \appendix command resets counters and redefines section heads
%
% After typing \appendix
%
%\section{Here Is Appendix Title}
% will show
% A: Here Is Appendix Title
%
%\appendix
%\section{Here is a sample appendix}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Optional Glossary, Notation or Acronym section goes here:
%
%%%%%%%%%%%%%%
% Glossary is only allowed in Reviews of Geophysics
%  \begin{glossary}
%  \term{Term}
%   Term Definition here
%  \term{Term}
%   Term Definition here
%  \term{Term}
%   Term Definition here
%  \end{glossary}

%
%%%%%%%%%%%%%%
% Acronyms
%   \begin{acronyms}
%   \acro{Acronym}
%   Definition here
%   \acro{EMOS}
%   Ensemble model output statistics
%   \acro{ECMWF}
%   Centre for Medium-Range Weather Forecasts
%   \end{acronyms}

%
%%%%%%%%%%%%%%
% Notation
%   \begin{notation}
%   \notation{$a+b$} Notation Definition here
%   \notation{$e=mc^2$}
%   Equation in German-born physicist Albert Einstein's theory of special
%  relativity that showed that the increased relativistic mass ($m$) of a
%  body comes from the energy of motion of the body—that is, its kinetic
%  energy ($E$)—divided by the speed of light squared ($c^2$).
%   \end{notation}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  ACKNOWLEDGMENTS
%
% The acknowledgments must list:
%
% >>>>	A statement that indicates to the reader where the data
% 	supporting the conclusions can be obtained (for example, in the
% 	references, tables, supporting information, and other databases).
%
% 	All funding sources related to this work from all authors
%
% 	Any real or perceived financial conflicts of interests for any
%	author
%
% 	Other affiliations for any author that may be perceived as
% 	having a conflict of interest with respect to the results of this
% 	paper.
%
%
% It is also the appropriate place to thank colleagues and other contributors.
% AGU does not normally allow dedications.


\acknowledgments
This material is based upon work supported by the National Center for Atmospheric Research (NCAR), which is a major facility sponsored by the NSF under Cooperative Agreement 1852977. Computing and data storage resources, including the Cheyenne supercomputer
(doi:10.5065/D6RX99HX), were provided by the Computational and Information Systems Laboratory (CISL) at NCAR.

The data presented in this manuscript is available at {\url{https://github.com/adamrher/2020-arcticgrids}}.



%% ------------------------------------------------------------------------ %%
%% References and Citations

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% \bibliography{<name of your .bib file>} don't specify the file extension
%
% don't specify bibliographystyle
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\bibliography{ enter your bibtex bibliography filename here }
\bibliography{bib}


%Reference citation instructions and examples:
%
% Please use ONLY \cite and \citeA for reference citations.
% \cite for parenthetical references
% ...as shown in recent studies (Simpson et al., 2019)
% \citeA for in-text citations
% ...Simpson et al. (2019) have shown...
%
%
%...as shown by \citeA{jskilby}.
%...as shown by \citeA{lewin76}, \citeA{carson86}, \citeA{bartoldy02}, and \citeA{rinaldi03}.
%...has been shown \cite{jskilbye}.
%...has been shown \cite{lewin76,carson86,bartoldy02,rinaldi03}.
%... \cite <i.e.>[]{lewin76,carson86,bartoldy02,rinaldi03}.
%...has been shown by \cite <e.g.,>[and others]{lewin76}.
%
% apacite uses < > for prenotes and [ ] for postnotes
% DO NOT use other cite commands (e.g., \citet, \citep, \citeyear, \nocite, \citealp, etc.).
%



\end{document}



More Information and Advice:

%% ------------------------------------------------------------------------ %%
%
%  SECTION HEADS
%
%% ------------------------------------------------------------------------ %%

% Capitalize the first letter of each word (except for
% prepositions, conjunctions, and articles that are
% three or fewer letters).

% AGU follows standard outline style; therefore, there cannot be a section 1 without
% a section 2, or a section 2.3.1 without a section 2.3.2.
% Please make sure your section numbers are balanced.
% ---------------
% Level 1 head
%
% Use the \section{} command to identify level 1 heads;
% type the appropriate head wording between the curly
% brackets, as shown below.
%
%An example:
%\section{Level 1 Head: Introduction}
%
% ---------------
% Level 2 head
%
% Use the \subsection{} command to identify level 2 heads.
%An example:
%\subsection{Level 2 Head}
%
% ---------------
% Level 3 head
%
% Use the \subsubsection{} command to identify level 3 heads
%An example:
%\subsubsection{Level 3 Head}
%
%---------------
% Level 4 head
%
% Use the \subsubsubsection{} command to identify level 3 heads
% An example:
%\subsubsubsection{Level 4 Head} An example.
%
%% ------------------------------------------------------------------------ %%
%
%  IN-TEXT LISTS
%
%% ------------------------------------------------------------------------ %%
%
% Do not use bulleted lists; enumerated lists are okay.
% \begin{enumerate}
% \item
% \item
% \item
% \end{enumerate}
%
%% ------------------------------------------------------------------------ %%
%
%  EQUATIONS
%
%% ------------------------------------------------------------------------ %%

% Single-line equations are centered.
% Equation arrays will appear left-aligned.

Math coded inside display math mode \[ ...\]
 will not be numbered, e.g.,:
 \[ x^2=y^2 + z^2\]

 Math coded inside \begin{equation} and \end{equation} will
 be automatically numbered, e.g.,:
 \begin{equation}
 x^2=y^2 + z^2
 \end{equation}


% To create multiline equations, use the
% \begin{eqnarray} and \end{eqnarray} environment
% as demonstrated below.
\begin{eqnarray}
  x_{1} & = & (x - x_{0}) \cos \Theta \nonumber \\
        && + (y - y_{0}) \sin \Theta  \nonumber \\
  y_{1} & = & -(x - x_{0}) \sin \Theta \nonumber \\
        && + (y - y_{0}) \cos \Theta.
\end{eqnarray}

%If you don't want an equation number, use the star form:
%\begin{eqnarray*}...\end{eqnarray*}

% Break each line at a sign of operation
% (+, -, etc.) if possible, with the sign of operation
% on the new line.

% Indent second and subsequent lines to align with
% the first character following the equal sign on the
% first line.

% Use an \hspace{} command to insert horizontal space
% into your equation if necessary. Place an appropriate
% unit of measure between the curly braces, e.g.
% \hspace{1in}; you may have to experiment to achieve
% the correct amount of space.


%% ------------------------------------------------------------------------ %%
%
%  EQUATION NUMBERING: COUNTER
%
%% ------------------------------------------------------------------------ %%

% You may change equation numbering by resetting
% the equation counter or by explicitly numbering
% an equation.

% To explicitly number an equation, type \eqnum{}
% (with the desired number between the brackets)
% after the \begin{equation} or \begin{eqnarray}
% command.  The \eqnum{} command will affect only
% the equation it appears with; LaTeX will number
% any equations appearing later in the manuscript
% according to the equation counter.
%

% If you have a multiline equation that needs only
% one equation number, use a \nonumber command in
% front of the double backslashes (\\) as shown in
% the multiline equation above.

% If you are using line numbers, remember to surround
% equations with \begin{linenomath*}...\end{linenomath*}

%  To add line numbers to lines in equations:
%  \begin{linenomath*}
%  \begin{equation}
%  \end{equation}
%  \end{linenomath*}



